/mnt/lustre/indy2lfs/work/m22oc/m22oc/s2311726/uoeRL/lib/python3.9/site-packages/gym/core.py:317: DeprecationWarning: [33mWARN: Initializing wrapper in old step API which returns one bool instead of two. It is recommended to set `new_step_api=True` to use new step API. This will be the default behaviour in future.[0m
  deprecation(
/mnt/lustre/indy2lfs/work/m22oc/m22oc/s2311726/uoeRL/lib/python3.9/site-packages/gym/wrappers/step_api_compatibility.py:39: DeprecationWarning: [33mWARN: Initializing environment in old step API which returns one bool instead of two. It is recommended to set `new_step_api=True` to use new step API. This will be the default behaviour in future.[0m
  deprecation(
  0%|          | 0/400000 [00:00<?, ?it/s]/mnt/lustre/indy2lfs/work/m22oc/m22oc/s2311726/uoeRL/lib/python3.9/site-packages/gym/utils/passive_env_checker.py:241: DeprecationWarning: `np.bool8` is a deprecated alias for `np.bool_`.  (Deprecated NumPy 1.24)
  if not isinstance(terminated, (bool, np.bool8)):
/mnt/lustre/indy2lfs/work/m22oc/m22oc/s2311726/uoeRL/lib/python3.9/site-packages/gym/utils/passive_env_checker.py:260: UserWarning: [33mWARN: The reward returned by `step()` must be a float, int, np.integer or np.floating, actual type: <class 'torch.Tensor'>[0m
  logger.warn(
/mnt/lustre/indy2lfs/work/m22oc/m22oc/s2311726/rl_test/agents.py:323: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  states = torch.tensor(states, device=device)
/mnt/lustre/indy2lfs/work/m22oc/m22oc/s2311726/rl_test/agents.py:324: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  actions = torch.tensor(actions, device=device)
/mnt/lustre/indy2lfs/work/m22oc/m22oc/s2311726/rl_test/agents.py:325: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  next_states = torch.tensor(next_states, device=device)
/mnt/lustre/indy2lfs/work/m22oc/m22oc/s2311726/rl_test/agents.py:326: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  rewards = torch.tensor(rewards, device=device)
/mnt/lustre/indy2lfs/work/m22oc/m22oc/s2311726/rl_test/agents.py:327: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  dones = torch.tensor(dones, device=device)
  0%|          | 200/400000 [00:12<6:55:14, 16.05it/s]  0%|          | 400/400000 [00:13<3:10:55, 34.88it/s]  0%|          | 600/400000 [00:14<1:59:18, 55.80it/s]  0%|          | 800/400000 [00:15<1:25:32, 77.77it/s]  0%|          | 1000/400000 [00:16<1:06:53, 99.43it/s]  0%|          | 1200/400000 [00:17<55:34, 119.58it/s]   0%|          | 1400/400000 [00:18<48:25, 137.21it/s]  0%|          | 1600/400000 [00:19<43:46, 151.68it/s]  0%|          | 1800/400000 [00:20<40:42, 163.05it/s]  0%|          | 2000/400000 [00:21<38:37, 171.77it/s]                                                        0%|          | 2000/400000 [00:22<38:37, 171.77it/s]  1%|          | 2200/400000 [00:23<43:23, 152.79it/s]  1%|          | 2400/400000 [00:24<40:28, 163.72it/s]  1%|          | 2600/400000 [00:25<38:25, 172.40it/s]  1%|          | 2800/400000 [00:26<36:56, 179.18it/s]  1%|          | 3000/400000 [00:27<35:56, 184.12it/s]  1%|          | 3200/400000 [00:28<35:15, 187.58it/s]  1%|          | 3400/400000 [00:29<34:45, 190.22it/s]  1%|          | 3600/400000 [00:30<34:28, 191.62it/s]  1%|          | 3800/400000 [00:31<34:14, 192.81it/s]  1%|          | 4000/400000 [00:32<34:03, 193.78it/s]                                                        1%|          | 4000/400000 [00:32<34:03, 193.78it/s]  1%|          | 4200/400000 [00:33<37:21, 176.56it/s]  1%|          | 4400/400000 [00:34<36:13, 181.97it/s]  1%|          | 4600/400000 [00:35<35:26, 185.97it/s]  1%|          | 4800/400000 [00:36<34:51, 188.91it/s]  1%|▏         | 5000/400000 [00:37<34:27, 191.03it/s]  1%|▏         | 5200/400000 [00:38<34:34, 190.33it/s]  1%|▏         | 5400/400000 [00:39<34:15, 191.98it/s]  1%|▏         | 5600/400000 [00:41<34:00, 193.30it/s]  1%|▏         | 5800/400000 [00:42<33:49, 194.21it/s]  2%|▏         | 6000/400000 [00:43<33:42, 194.83it/s]                                                        2%|▏         | 6000/400000 [00:43<33:42, 194.83it/s]  2%|▏         | 6200/400000 [00:44<37:02, 177.21it/s]  2%|▏         | 6400/400000 [00:45<35:59, 182.30it/s]  2%|▏         | 6600/400000 [00:46<35:13, 186.13it/s]  2%|▏         | 6800/400000 [00:47<34:39, 189.08it/s]  2%|▏         | 7000/400000 [00:48<34:15, 191.22it/s]  2%|▏         | 7200/400000 [00:49<33:57, 192.76it/s]  2%|▏         | 7400/400000 [00:50<33:47, 193.60it/s]  2%|▏         | 7600/400000 [00:51<33:38, 194.38it/s]  2%|▏         | 7800/400000 [00:52<33:33, 194.82it/s]  2%|▏         | 8000/400000 [00:53<33:27, 195.30it/s]                                                        2%|▏         | 8000/400000 [00:53<33:27, 195.30it/s]  2%|▏         | 8200/400000 [00:54<36:43, 177.84it/s]  2%|▏         | 8400/400000 [00:55<35:37, 183.25it/s]  2%|▏         | 8600/400000 [00:56<34:50, 187.21it/s]  2%|▏         | 8800/400000 [00:58<34:20, 189.84it/s]  2%|▏         | 9000/400000 [00:59<34:01, 191.56it/s]  2%|▏         | 9200/400000 [01:00<33:44, 193.01it/s]  2%|▏         | 9400/400000 [01:01<33:30, 194.27it/s]  2%|▏         | 9600/400000 [01:02<33:19, 195.20it/s]  2%|▏         | 9800/400000 [01:03<33:14, 195.64it/s]  2%|▎         | 10000/400000 [01:04<33:09, 196.07it/s]                                                         2%|▎         | 10000/400000 [01:04<33:09, 196.07it/s]  3%|▎         | 10200/400000 [01:05<36:25, 178.37it/s]  3%|▎         | 10400/400000 [01:06<35:19, 183.81it/s]  3%|▎         | 10600/400000 [01:07<34:35, 187.65it/s]  3%|▎         | 10800/400000 [01:08<34:03, 190.46it/s]  3%|▎         | 11000/400000 [01:09<33:41, 192.46it/s]  3%|▎         | 11200/400000 [01:10<33:24, 193.92it/s]  3%|▎         | 11400/400000 [01:11<33:16, 194.67it/s]  3%|▎         | 11600/400000 [01:12<33:03, 195.77it/s]  3%|▎         | 11800/400000 [01:13<32:56, 196.46it/s]  3%|▎         | 12000/400000 [01:14<32:54, 196.51it/s]                                                         3%|▎         | 12000/400000 [01:14<32:54, 196.51it/s]  3%|▎         | 12200/400000 [01:15<36:11, 178.60it/s]  3%|▎         | 12400/400000 [01:16<35:07, 183.94it/s]  3%|▎         | 12600/400000 [01:17<34:22, 187.82it/s]  3%|▎         | 12800/400000 [01:18<33:52, 190.53it/s]  3%|▎         | 13000/400000 [01:19<33:29, 192.60it/s]  3%|▎         | 13200/400000 [01:20<33:11, 194.19it/s]  3%|▎         | 13400/400000 [01:22<32:58, 195.37it/s]  3%|▎         | 13600/400000 [01:23<32:52, 195.86it/s]  3%|▎         | 13800/400000 [01:24<32:49, 196.10it/s]  4%|▎         | 14000/400000 [01:25<32:46, 196.31it/s]                                                         4%|▎         | 14000/400000 [01:25<32:46, 196.31it/s]  4%|▎         | 14200/400000 [01:26<36:01, 178.51it/s]  4%|▎         | 14400/400000 [01:27<35:00, 183.55it/s]  4%|▎         | 14600/400000 [01:28<34:13, 187.67it/s]  4%|▎         | 14800/400000 [01:29<33:42, 190.42it/s]  4%|▍         | 15000/400000 [01:30<33:19, 192.55it/s]  4%|▍         | 15200/400000 [01:31<33:02, 194.08it/s]  4%|▍         | 15400/400000 [01:32<32:51, 195.09it/s]  4%|▍         | 15600/400000 [01:33<32:42, 195.88it/s]  4%|▍         | 15800/400000 [01:34<32:36, 196.37it/s]  4%|▍         | 16000/400000 [01:35<32:34, 196.47it/s]                                                         4%|▍         | 16000/400000 [01:35<32:34, 196.47it/s]  4%|▍         | 16200/400000 [01:36<35:48, 178.65it/s]  4%|▍         | 16400/400000 [01:37<34:46, 183.87it/s]  4%|▍         | 16600/400000 [01:38<34:03, 187.60it/s]  4%|▍         | 16800/400000 [01:39<33:32, 190.43it/s]  4%|▍         | 17000/400000 [01:40<33:08, 192.59it/s]  4%|▍         | 17200/400000 [01:41<32:53, 193.94it/s]  4%|▍         | 17400/400000 [01:42<32:41, 195.04it/s]  4%|▍         | 17600/400000 [01:43<32:33, 195.79it/s]  4%|▍         | 17800/400000 [01:44<32:31, 195.83it/s]  4%|▍         | 18000/400000 [01:46<32:37, 195.18it/s]                                                         4%|▍         | 18000/400000 [01:46<32:37, 195.18it/s]  5%|▍         | 18200/400000 [01:47<35:41, 178.30it/s]  5%|▍         | 18400/400000 [01:48<34:29, 184.40it/s]  5%|▍         | 18600/400000 [01:49<33:36, 189.11it/s]  5%|▍         | 18800/400000 [01:50<33:03, 192.23it/s]  5%|▍         | 19000/400000 [01:51<32:39, 194.47it/s]  5%|▍         | 19200/400000 [01:52<32:22, 195.99it/s]  5%|▍         | 19400/400000 [01:53<32:09, 197.21it/s]  5%|▍         | 19600/400000 [01:54<32:01, 198.00it/s]  5%|▍         | 19800/400000 [01:55<31:54, 198.61it/s]  5%|▌         | 20000/400000 [01:56<31:48, 199.10it/s]                                                         5%|▌         | 20000/400000 [01:56<31:48, 199.10it/s]  5%|▌         | 20200/400000 [01:57<34:53, 181.44it/s]  5%|▌         | 20400/400000 [01:58<33:51, 186.85it/s]  5%|▌         | 20600/400000 [01:59<33:09, 190.66it/s]  5%|▌         | 20800/400000 [02:00<32:40, 193.43it/s]  5%|▌         | 21000/400000 [02:01<32:17, 195.61it/s]  5%|▌         | 21200/400000 [02:02<32:02, 197.08it/s]  5%|▌         | 21400/400000 [02:03<31:52, 198.01it/s]  5%|▌         | 21600/400000 [02:04<31:43, 198.77it/s]  5%|▌         | 21800/400000 [02:05<31:39, 199.07it/s]  6%|▌         | 22000/400000 [02:06<31:36, 199.32it/s]                                                         6%|▌         | 22000/400000 [02:07<31:36, 199.32it/s]  6%|▌         | 22200/400000 [02:08<34:42, 181.44it/s]  6%|▌         | 22400/400000 [02:09<33:41, 186.79it/s]  6%|▌         | 22600/400000 [02:10<33:00, 190.51it/s]  6%|▌         | 22800/400000 [02:11<32:29, 193.44it/s]  6%|▌         | 23000/400000 [02:12<32:08, 195.53it/s]  6%|▌         | 23200/400000 [02:13<31:53, 196.92it/s]  6%|▌         | 23400/400000 [02:14<31:45, 197.67it/s]  6%|▌         | 23600/400000 [02:15<31:40, 198.06it/s]  6%|▌         | 23800/400000 [02:16<31:33, 198.67it/s]  6%|▌         | 24000/400000 [02:17<31:26, 199.29it/s]                                                         6%|▌         | 24000/400000 [02:17<31:26, 199.29it/s]  6%|▌         | 24200/400000 [02:18<34:30, 181.52it/s]  6%|▌         | 24400/400000 [02:19<33:30, 186.78it/s]  6%|▌         | 24600/400000 [02:20<32:48, 190.69it/s]  6%|▌         | 24800/400000 [02:21<32:20, 193.40it/s]  6%|▋         | 25000/400000 [02:22<32:00, 195.29it/s]  6%|▋         | 25200/400000 [02:23<31:44, 196.81it/s]  6%|▋         | 25400/400000 [02:24<31:35, 197.59it/s]  6%|▋         | 25600/400000 [02:25<31:29, 198.13it/s]  6%|▋         | 25800/400000 [02:26<31:21, 198.84it/s]  6%|▋         | 26000/400000 [02:27<31:16, 199.27it/s]                                                         6%|▋         | 26000/400000 [02:27<31:16, 199.27it/s]  7%|▋         | 26200/400000 [02:28<34:20, 181.44it/s]  7%|▋         | 26400/400000 [02:29<33:20, 186.72it/s]  7%|▋         | 26600/400000 [02:30<32:40, 190.50it/s]  7%|▋         | 26800/400000 [02:31<32:11, 193.19it/s]  7%|▋         | 27000/400000 [02:32<31:48, 195.41it/s]  7%|▋         | 27200/400000 [02:33<31:35, 196.66it/s]  7%|▋         | 27400/400000 [02:34<31:25, 197.63it/s]  7%|▋         | 27600/400000 [02:35<31:19, 198.14it/s]  7%|▋         | 27800/400000 [02:36<31:10, 199.02it/s]  7%|▋         | 28000/400000 [02:37<31:05, 199.41it/s]                                                         7%|▋         | 28000/400000 [02:38<31:05, 199.41it/s]  7%|▋         | 28200/400000 [02:39<34:11, 181.25it/s]  7%|▋         | 28400/400000 [02:40<33:11, 186.60it/s]  7%|▋         | 28600/400000 [02:41<32:31, 190.33it/s]  7%|▋         | 28800/400000 [02:42<32:02, 193.10it/s]  7%|▋         | 29000/400000 [02:43<31:42, 194.97it/s]  7%|▋         | 29200/400000 [02:44<31:27, 196.47it/s]  7%|▋         | 29400/400000 [02:45<31:16, 197.50it/s]  7%|▋         | 29600/400000 [02:46<31:09, 198.15it/s]  7%|▋         | 29800/400000 [02:47<31:03, 198.71it/s]  8%|▊         | 30000/400000 [02:48<30:56, 199.31it/s]                                                         8%|▊         | 30000/400000 [02:48<30:56, 199.31it/s]  8%|▊         | 30200/400000 [02:49<33:58, 181.42it/s]  8%|▊         | 30400/400000 [02:50<32:58, 186.78it/s]  8%|▊         | 30600/400000 [02:51<32:19, 190.44it/s]  8%|▊         | 30800/400000 [02:52<31:50, 193.23it/s]  8%|▊         | 31000/400000 [02:53<31:30, 195.23it/s]  8%|▊         | 31200/400000 [02:54<31:18, 196.37it/s]  8%|▊         | 31400/400000 [02:55<31:07, 197.37it/s]  8%|▊         | 31600/400000 [02:56<31:00, 198.01it/s]  8%|▊         | 31800/400000 [02:57<30:55, 198.42it/s]  8%|▊         | 32000/400000 [02:58<30:50, 198.83it/s]                                                         8%|▊         | 32000/400000 [02:58<30:50, 198.83it/s]  8%|▊         | 32200/400000 [02:59<33:53, 180.89it/s]  8%|▊         | 32400/400000 [03:00<32:53, 186.31it/s]  8%|▊         | 32600/400000 [03:01<32:10, 190.30it/s]  8%|▊         | 32800/400000 [03:02<31:42, 193.06it/s]  8%|▊         | 33000/400000 [03:03<31:25, 194.67it/s]  8%|▊         | 33200/400000 [03:04<31:12, 195.88it/s]  8%|▊         | 33400/400000 [03:05<30:57, 197.31it/s]  8%|▊         | 33600/400000 [03:06<30:50, 197.95it/s]  8%|▊         | 33800/400000 [03:07<30:45, 198.48it/s]  8%|▊         | 34000/400000 [03:08<30:42, 198.68it/s]                                                         8%|▊         | 34000/400000 [03:09<30:42, 198.68it/s]  9%|▊         | 34200/400000 [03:10<33:37, 181.29it/s]  9%|▊         | 34400/400000 [03:11<32:40, 186.51it/s]  9%|▊         | 34600/400000 [03:12<32:00, 190.24it/s]  9%|▊         | 34800/400000 [03:13<31:31, 193.10it/s]  9%|▉         | 35000/400000 [03:14<31:10, 195.13it/s]  9%|▉         | 35200/400000 [03:15<30:59, 196.20it/s]  9%|▉         | 35400/400000 [03:16<30:48, 197.24it/s]  9%|▉         | 35600/400000 [03:17<30:43, 197.70it/s]  9%|▉         | 35800/400000 [03:18<30:37, 198.23it/s]  9%|▉         | 36000/400000 [03:19<30:31, 198.75it/s]                                                         9%|▉         | 36000/400000 [03:19<30:31, 198.75it/s]  9%|▉         | 36200/400000 [03:20<33:28, 181.13it/s]  9%|▉         | 36400/400000 [03:21<32:30, 186.46it/s]  9%|▉         | 36600/400000 [03:22<31:49, 190.28it/s]  9%|▉         | 36800/400000 [03:23<31:21, 192.99it/s]  9%|▉         | 37000/400000 [03:24<31:03, 194.74it/s]  9%|▉         | 37200/400000 [03:25<30:49, 196.20it/s]  9%|▉         | 37400/400000 [03:26<30:36, 197.47it/s]  9%|▉         | 37600/400000 [03:27<30:33, 197.65it/s]  9%|▉         | 37800/400000 [03:28<30:25, 198.36it/s] 10%|▉         | 38000/400000 [03:29<30:20, 198.81it/s]                                                        10%|▉         | 38000/400000 [03:29<30:20, 198.81it/s] 10%|▉         | 38200/400000 [03:30<33:16, 181.21it/s] 10%|▉         | 38400/400000 [03:31<32:20, 186.31it/s] 10%|▉         | 38600/400000 [03:32<31:40, 190.12it/s] 10%|▉         | 38800/400000 [03:33<31:10, 193.14it/s] 10%|▉         | 39000/400000 [03:34<30:50, 195.05it/s] 10%|▉         | 39200/400000 [03:35<30:37, 196.33it/s] 10%|▉         | 39400/400000 [03:36<30:24, 197.64it/s] 10%|▉         | 39600/400000 [03:37<30:16, 198.43it/s] 10%|▉         | 39800/400000 [03:38<30:16, 198.26it/s] 10%|█         | 40000/400000 [03:39<30:10, 198.80it/s]                                                        10%|█         | 40000/400000 [03:40<30:10, 198.80it/s] 10%|█         | 40200/400000 [03:41<33:05, 181.20it/s] 10%|█         | 40400/400000 [03:42<32:10, 186.23it/s] 10%|█         | 40600/400000 [03:43<31:28, 190.31it/s] 10%|█         | 40800/400000 [03:44<31:00, 193.09it/s] 10%|█         | 41000/400000 [03:45<30:43, 194.77it/s] 10%|█         | 41200/400000 [03:46<30:26, 196.43it/s] 10%|█         | 41400/400000 [03:47<30:16, 197.46it/s] 10%|█         | 41600/400000 [03:48<30:07, 198.29it/s] 10%|█         | 41800/400000 [03:49<30:01, 198.86it/s] 10%|█         | 42000/400000 [03:50<29:57, 199.11it/s]                                                        10%|█         | 42000/400000 [03:50<29:57, 199.11it/s] 11%|█         | 42200/400000 [03:51<32:53, 181.31it/s] 11%|█         | 42400/400000 [03:52<31:58, 186.43it/s] 11%|█         | 42600/400000 [03:53<31:16, 190.50it/s] 11%|█         | 42800/400000 [03:54<30:50, 192.99it/s] 11%|█         | 43000/400000 [03:55<30:32, 194.87it/s] 11%|█         | 43200/400000 [03:56<30:18, 196.20it/s] 11%|█         | 43400/400000 [03:57<30:08, 197.16it/s] 11%|█         | 43600/400000 [03:58<29:59, 198.07it/s] 11%|█         | 43800/400000 [03:59<29:55, 198.42it/s] 11%|█         | 44000/400000 [04:00<29:53, 198.49it/s]                                                        11%|█         | 44000/400000 [04:00<29:53, 198.49it/s]                                                        11%|█         | 44000/400000 [04:00<29:53, 198.49it/s] 11%|█         | 44000/400000 [04:00<32:28, 182.75it/s]
